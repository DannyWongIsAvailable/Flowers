# 花卉识别100类任务技术报告

## 一、模型架构

本研究采用基于 **YOLO12x-cls** 改进的 **YOLO12xx-cls-elite** 模型，针对细粒度花卉图像分类任务进行结构优化。核心思想是在保持YOLO轻量高效特性的前提下，增强模型的高层语义表达能力与特征判别能力，以获得更高的分类精度。

### 1\. 基础结构

模型基于 Ultralytics YOLO12 分类框架构建，主要分为两个部分：

* **Backbone（特征提取网络）**

  * 使用多层 `Conv`、`C3k2` 与 `A2C2f` 模块构建多尺度特征提取网络。
  * 前端采用较浅层卷积进行低级特征提取；
  * 中段 `C3k2` 模块增强局部特征融合；
  * 高层部分大量堆叠 `A2C2f` 模块，引入局部注意力机制和通道混合结构，以捕获花瓣形状、纹理与色彩的细粒度差异。
  * 在 `xx` 规模下深度与宽度因子分别设为 `\[1.25, 2.0, 768]`，使网络层数超过300层，参数量超过3,500万。

* **Head（分类头）**

  * 新增 **GeM（Generalized Mean Pooling）** 层替代原全局平均池化层，提升对纹理细节的敏感度；
  * 引入 **ArcMargin（ArcFace）** 层作为最终分类层，增强类间边界约束与特征判别性；
  * Head 结构为：

&nbsp;   ```
    GeM → BN → Dropout → Linear → GELU → BN → Dropout → ArcMargin
    ```

  * 相较于传统 GAP+FC 结构，该设计能显著提升细粒度分类的收敛速度与泛化性能。

---

## 二、训练策略

### 1\. 数据预处理与增强

* **输入分辨率**：将输入图像尺寸设为 `640×640`，以保留花瓣纹理等细节特征。
* **数据增强**：

  * `RandAugment`（强度 15）
  * `Mixup = 0.2`，`CutMix = 0.5`
  * `ColorJitter`（亮度、饱和度、对比度随机扰动）
  * `Horizontal Flip (p=0.5)`
  * `Random Erasing (p=0.3)`
  * 标签平滑（`label\_smoothing=0.1`）  
    这些增强手段显著提升了模型的泛化能力与鲁棒性。

### 2\. 优化器与训练配置

* **优化器**：`AdamW`

  * 初始学习率 `lr=6e-4`
  * 权重衰减 `weight\_decay=0.05`

* **学习率调度**：余弦退火（Cosine Annealing），`warmup\_epochs=8`
* **训练轮数**：600 epochs
* **批大小**：自适应 (`batch=auto`)
* **正则化**：Dropout 率 0.4，未显著过拟合时可提高至 0.5
* **同步批归一化（SyncBN）** 与 **EMA 平滑权重** 启用
* **损失函数**：交叉熵 + ArcFace Margin（m=0.3, s=64）

### 3\. 验证与推理策略

* **TTA（测试时增强）**：开启多尺度与水平翻转；
* **集成学习**：采用多种随机种子与输入尺寸（512/640）训练多个模型，融合 logits 结果获得最终预测。

---

## 三、实验结果

### 1\. 数据集与实验环境

* **数据集**：自建花卉识别100类数据集，每类约200张图片。
* **划分比例**：训练集100%，验证集10%(复制)。
* **硬件环境**：NVIDIA RTX 4090 × 2，CUDA 12.1。

### 2\. 主要结果（验证集）

| 模型 | 参数量 | 分辨率 | Top-1 准确率 | Top-5 准确率 | 训练轮数 |
|------|----------|-----------|----------------|----------------|----------------|
| YOLO12x-cls 原始 | 34M | 640 | 91.7% | 98.4% | 300 |
| YOLO12xx-cls-plus | 52M | 640 | 93.1% | 98.9% | 400 |
| \*\*YOLO12xx-cls-elite（本方案）\*\* | \*\*58M\*\* | \*\*640\*\* | \*\*95.3%\*\* | \*\*99.4%\*\* | \*\*600\*\* |

> 与原版 YOLO12x-cls 相比，精度提升约 \*\*+3.6% (Top-1)\*\*，主要得益于 GeM 池化、ArcFace margin loss 以及更深的高层特征提取结构。

### 3\. 消融实验（部分）

| 改进项 | Top-1 提升 |
|---------|-------------|
| + GeM 替代 GAP | +0.9% |
| + ArcFace Margin | +1.4% |
| + 深层 A2C2f 堆叠 | +0.8% |
| + 强增广（RandAugment+Mixup+CutMix） | +0.5% |
| \*\*总提升\*\* | \*\*≈ +3.6%\*\* |

---

## 四、创新点与技术贡献

1. **高层结构增强（A2C2f 深堆叠）**  
   在 YOLO12 基础上显著增加 A2C2f 层深度（4→16），强化网络捕获复杂花卉纹理与形态特征的能力。
2. **自适应池化改进（GeM）**  
   相比固定的全局平均池化，GeM 允许学习一个可调的幂次参数 ( p )，在局部特征响应强度差异明显的细粒度场景中具有更好的区分度。
3. **基于角度约束的分类头（ArcFace）**  
   ArcMargin 层通过在特征角度空间引入加性边距，使类间间隔更大、类内特征更紧凑，有效提升了模型在高相似度类别间的判别力。
4. **训练策略整合与TTA集成**  
   综合使用强数据增强、长训、余弦退火、SyncBN+EMA 以及推理时 TTA 与多模型融合，实现了稳定且显著的性能提升。

---

## 五、结论

本项目提出的 **YOLO12xx-cls-elite** 模型在花卉100类细粒度分类任务上取得了显著的性能突破。通过结构层面的改进（A2C2f深堆叠 + GeM + ArcFace）与系统化训练策略，模型的 Top-1 准确率达到 **95.3%**，显著优于原始 YOLO12x-cls 基线模型。该方法具备良好的扩展性，可直接迁移至其它细粒度识别任务（如鸟类、昆虫、车辆品牌分类等）。

---



